{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { BASE_URL } from \"../../utils/constants\";\nexport const createUser = createAsyncThunk(\"users/createUser\", async (payload, thunkAPI) => {\n  try {\n    const res = await axios.post(`${BASE_URL}/users`, payload);\n    return res.data;\n  } catch (err) {\n    console.log(err);\n    return thunkAPI.rejectWithValue(err);\n  }\n});\nexport const loginUser = createAsyncThunk(\"users/loginUser\", async (payload, thunkAPI) => {\n  try {\n    const res = await axios.post(`${BASE_URL}/auth/login`, payload);\n    const login = await axios(`${BASE_URL}/auth/profile`, {\n      headers: {\n        Authorization: `Bearer ${res.data.access_token}`\n      }\n    });\n    return login.data;\n  } catch (err) {\n    console.log(err);\n    return thunkAPI.rejectWithValue(err);\n  }\n});\nexport const updateUser = createAsyncThunk(\"users/updateUser\", async (payload, thunkAPI) => {\n  try {\n    const res = await axios.put(`${BASE_URL}/users/${payload.id}`, payload);\n    return res.data;\n  } catch (err) {\n    console.log(err);\n    return thunkAPI.rejectWithValue(err);\n  }\n});\nconst addCurrentUser = (state, _ref) => {\n  let {\n    payload\n  } = _ref;\n  state.currentUser = payload;\n};\nconst userSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    currentUser: null,\n    cart: [],\n    isLoading: false,\n    formType: \"signup\",\n    showForm: false\n  },\n  reducers: {\n    addItemToCart: (state, _ref2) => {\n      let {\n        payload\n      } = _ref2;\n      let newCart = [...state.cart];\n      const found = state.cart.find(_ref3 => {\n        let {\n          id\n        } = _ref3;\n        return id === payload.id;\n      });\n      if (found) {\n        newCart = newCart.map(item => {\n          return item.id === payload.id ? {\n            ...item,\n            quantity: payload.quantity || item.quantity + 1\n          } : item;\n        });\n      } else newCart.push({\n        ...payload,\n        quantity: 1\n      });\n      state.cart = newCart;\n    },\n    removeItemFromCart: (state, _ref4) => {\n      let {\n        payload\n      } = _ref4;\n      state.cart = state.cart.filter(_ref5 => {\n        let {\n          id\n        } = _ref5;\n        return id !== payload;\n      });\n    },\n    toggleForm: (state, _ref6) => {\n      let {\n        payload\n      } = _ref6;\n      state.showForm = payload;\n    },\n    toggleFormType: (state, _ref7) => {\n      let {\n        payload\n      } = _ref7;\n      state.formType = payload;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(createUser.fulfilled, addCurrentUser);\n    builder.addCase(loginUser.fulfilled, addCurrentUser);\n    builder.addCase(updateUser.fulfilled, addCurrentUser);\n  }\n});\nexport const {\n  addItemToCart,\n  removeItemFromCart,\n  toggleForm,\n  toggleFormType\n} = userSlice.actions;\nexport default userSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","BASE_URL","createUser","payload","thunkAPI","res","post","data","err","console","log","rejectWithValue","loginUser","login","headers","Authorization","access_token","updateUser","put","id","addCurrentUser","state","_ref","currentUser","userSlice","name","initialState","cart","isLoading","formType","showForm","reducers","addItemToCart","_ref2","newCart","found","find","_ref3","map","item","quantity","push","removeItemFromCart","_ref4","filter","_ref5","toggleForm","_ref6","toggleFormType","_ref7","extraReducers","builder","addCase","fulfilled","actions","reducer"],"sources":["C:/Users/bogda/Downloads/stuff-master/src/features/user/userSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { BASE_URL } from \"../../utils/constants\";\n\nexport const createUser = createAsyncThunk(\n  \"users/createUser\",\n  async (payload, thunkAPI) => {\n    try {\n      const res = await axios.post(`${BASE_URL}/users`, payload);\n      return res.data;\n    } catch (err) {\n      console.log(err);\n      return thunkAPI.rejectWithValue(err);\n    }\n  }\n);\n\nexport const loginUser = createAsyncThunk(\n  \"users/loginUser\",\n  async (payload, thunkAPI) => {\n    try {\n      const res = await axios.post(`${BASE_URL}/auth/login`, payload);\n      const login = await axios(`${BASE_URL}/auth/profile`, {\n        headers: {\n          Authorization: `Bearer ${res.data.access_token}`,\n        },\n      });\n\n      return login.data;\n    } catch (err) {\n      console.log(err);\n      return thunkAPI.rejectWithValue(err);\n    }\n  }\n);\n\nexport const updateUser = createAsyncThunk(\n  \"users/updateUser\",\n  async (payload, thunkAPI) => {\n    try {\n      const res = await axios.put(`${BASE_URL}/users/${payload.id}`, payload);\n      return res.data;\n    } catch (err) {\n      console.log(err);\n      return thunkAPI.rejectWithValue(err);\n    }\n  }\n);\n\nconst addCurrentUser = (state, { payload }) => {\n  state.currentUser = payload;\n};\n\nconst userSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    currentUser: null,\n    cart: [],\n    isLoading: false,\n    formType: \"signup\",\n    showForm: false,\n  },\n  reducers: {\n    addItemToCart: (state, { payload }) => {\n      let newCart = [...state.cart];\n      const found = state.cart.find(({ id }) => id === payload.id);\n\n      if (found) {\n        newCart = newCart.map((item) => {\n          return item.id === payload.id\n            ? { ...item, quantity: payload.quantity || item.quantity + 1 }\n            : item;\n        });\n      } else newCart.push({ ...payload, quantity: 1 });\n\n      state.cart = newCart;\n    },\n    removeItemFromCart: (state, { payload }) => {\n      state.cart = state.cart.filter(({ id }) => id !== payload);\n    },\n    toggleForm: (state, { payload }) => {\n      state.showForm = payload;\n    },\n    toggleFormType: (state, { payload }) => {\n      state.formType = payload;\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(createUser.fulfilled, addCurrentUser);\n    builder.addCase(loginUser.fulfilled, addCurrentUser);\n    builder.addCase(updateUser.fulfilled, addCurrentUser);\n  },\n});\n\nexport const { addItemToCart, removeItemFromCart, toggleForm, toggleFormType } =\n  userSlice.actions;\n\nexport default userSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}